# White-X 脚本集合

本文件夹包含与 White-X 插件集成的 JavaScript 脚本。

## extract-context.js

提取 White-X 上下文信息脚本。读取本地变量并生成 XML 格式的上下文字符串。

### 功能

该脚本提取以下数据：

**世界信息**
- 时间（ISO8601 格式）
- 地点

**用户（摄影师）数据**
- 拍摄任务（任务列表）
- 资金（数值）
- 堕落度（数值）

**女性角色数据**
- 好感度
- 堕落度
- 动情程度
- 尺度
- 人设

### 使用方法

```bash
# 直接运行
node x-scripts/extract-context.js

# 或使用 npm 脚本
pnpm x:context
```

### 输出格式

脚本输出 XML 格式的上下文字符串：

```xml
<context>
{
  "世界": {
    "时间": "2024-12-16T14:30:00+0800",
    "地点": "[北京]昌平仓库工作室"
  },
  "用户": {
    "拍摄任务": [...],
    "资金": 10000,
    "堕落度": 0
  },
  "女性角色": {
    "六花": {
      "好感度": 0,
      "堕落度": 0,
      "动情程度": null,
      "尺度": null,
      "人设": null
    }
  }
}
</context>
```

### 数据加载策略

脚本使用与 `src/main.js` 相同的数据加载器，遵循以下优先级：

1. 优先加载生产数据（通过 STscript API，本地不可用）
2. 回退到测试数据（`data/status-vars.debug.json`）

### 依赖

- Node.js 内置模块（无外部依赖）
- 本地数据文件：`data/status-vars.debug.json`

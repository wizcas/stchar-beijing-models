# ğŸ® Beijing Models - SillyTavern è§’è‰²å¡é…ç½®ç³»ç»Ÿ

> æ¨¡æ‹Ÿç½‘ç»œäººä½“æ‘„å½±è¡Œä¸šçš„é«˜æ²‰æµ¸å¼æ¸¸æˆé…ç½®ç³»ç»Ÿï¼Œä¸º SillyTavern é‡èº«å®šåˆ¶ã€‚

## ğŸ“– é¡¹ç›®ç®€ä»‹

**Beijing Models** æ˜¯ä¸€ä¸ªåŸºäº **SillyTavern** çš„è§’è‰²å¡é…ç½®å’ŒçŠ¶æ€ç®¡ç†ç³»ç»Ÿï¼Œæ ¸å¿ƒè®¾å®šå›´ç»•ç½‘ç»œäººä½“æ‘„å½±è¡Œä¸šå±•å¼€ã€‚é¡¹ç›®åŒ…å«ï¼š

- ğŸ­ **å®Œæ•´çš„è§’è‰²è®¾å®šç³»ç»Ÿ** - æ‘„å½±å¸ˆå’Œæ¨¡ç‰¹çš„å¤šç»´å±æ€§ç®¡ç†
- ğŸ“Š **çŠ¶æ€ä»ªè¡¨æ¿** - å®æ—¶æ˜¾ç¤ºè§’è‰²çŠ¶æ€ã€å¥½æ„Ÿåº¦ã€å •è½åº¦ç­‰
- ğŸ¯ **éšæ€§è§„åˆ™å¼•æ“** - è‡ªåŠ¨ç”Ÿæˆéšæœºæ¨¡ç‰¹ã€ç®¡ç†å¥½æ„Ÿåº¦ç³»ç»Ÿã€æ§åˆ¶å •è½åº¦æœºåˆ¶
- ğŸ“ **worldbooks ä½“ç³»** - è¯¦ç»†çš„æ¸¸æˆè§„åˆ™å’Œè®¾å®šæ–‡æ¡£
- âš™ï¸ **é…ç½®è‡ªåŠ¨åŒ–** - YAML schema + JSON è¦†ç›– + è‡ªåŠ¨åŒæ­¥æœºåˆ¶

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
pnpm install
# æˆ–
npm install
```

### é…ç½®ç³»ç»Ÿ

#### ç”Ÿæˆ/éªŒè¯é…ç½®

```bash
# æ„å»ºé…ç½®ï¼ˆè‡ªåŠ¨åŒæ­¥ status.yaml åˆ° status.jsonï¼‰
pnpm config:build

# éªŒè¯é…ç½®ï¼ˆæ£€æŸ¥ schema å’Œæ•°æ®ä¸€è‡´æ€§ï¼‰
pnpm config:verify

# åŒæ—¶è¿›è¡Œ
pnpm config:build && pnpm config:verify
```

#### Token ç»Ÿè®¡åˆ†æ

```bash
# å¿«é€ŸæŸ¥çœ‹ worldbooks æ–‡ä»¶çš„ token é¢„ä¼°
pnpm analyze:tokens

# æ˜¾ç¤ºè¯¦ç»†åˆ†æä¿¡æ¯
pnpm analyze:tokens:verbose

# å¯¼å‡ºä¸º JSON æ ¼å¼
pnpm analyze:tokens:json > report.json

# å¯¼å‡ºä¸º CSV æ ¼å¼ï¼ˆå¯åœ¨ Excel ä¸­æ‰“å¼€ï¼‰
node analyze-tokens.js --format csv > worldbooks_tokens.csv

# åªæ˜¾ç¤ºè¶…è¿‡ 2500 tokens çš„æ–‡ä»¶
node analyze-tokens.js --threshold 2500
```

è¯¦è§ [TOKEN_ANALYSIS.md](./TOKEN_ANALYSIS.md)

### å‰ç«¯ä»ªè¡¨æ¿

#### å¼€å‘æ¨¡å¼

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œæ”¯æŒçƒ­é‡è½½
pnpm dev
```

#### ç”Ÿäº§æ„å»º

```bash
# ä¸€æ¬¡æ€§æ„å»º
pnpm build

# ç”Ÿäº§ä¼˜åŒ–æ„å»º
pnpm build:prod

# ç”Ÿäº§æ„å»ºï¼ˆä¸å‹ç¼©ï¼Œä¾¿äºè°ƒè¯•ï¼‰
pnpm build:prod:debug
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
beijing-models/
â”œâ”€â”€ ğŸ“‚ src/                          # å‰ç«¯æºä»£ç 
â”‚   â”œâ”€â”€ index.html                  # HTML æ¨¡æ¿
â”‚   â”œâ”€â”€ main.js                     # çŠ¶æ€ä»ªè¡¨æ¿é€»è¾‘
â”‚   â”œâ”€â”€ renderer.js                 # æ¸²æŸ“å¼•æ“
â”‚   â””â”€â”€ style.css                   # Tailwind CSS æ ·å¼
â”‚
â”œâ”€â”€ ğŸ“‚ data/                         # æ¸¸æˆæ•°æ®é…ç½®
â”‚   â”œâ”€â”€ status.yaml                 # Schema å®šä¹‰ï¼ˆæ‰€æœ‰å­—æ®µæ¨¡æ¿ï¼‰
â”‚   â”œâ”€â”€ status.json                 # è¿è¡Œæ—¶æ•°æ®ï¼ˆåˆå§‹å€¼è¦†ç›–ï¼‰
â”‚   â””â”€â”€ status-vars.debug.json      # è‡ªåŠ¨ç”Ÿæˆçš„åˆå¹¶æ•°æ®ï¼ˆè°ƒè¯•ç”¨ï¼‰
â”‚
â”œâ”€â”€ ğŸ“‚ worldbooks/                   # æ¸¸æˆè®¾å®šæ–‡æ¡£ï¼ˆAI æç¤ºè¯åº“ï¼‰
â”‚   â”œâ”€â”€ {{user}}.md                 # æ‘„å½±å¸ˆï¼ˆç©å®¶ï¼‰è§’è‰²è®¾å®š
â”‚   â”œâ”€â”€ opening.md                  # æ¸¸æˆå¼€åœºå‰§æœ¬
â”‚   â”œâ”€â”€ status.md                   # çŠ¶æ€ç³»ç»Ÿå­—æ®µæ–‡æ¡£
â”‚   â”œâ”€â”€ favor-system.md             # å¥½æ„Ÿåº¦ç³»ç»Ÿè§„åˆ™
â”‚   â”œâ”€â”€ moral-system.md             # å •è½åº¦ç³»ç»Ÿè§„åˆ™
â”‚   â”œâ”€â”€ model-system.md             # æ¨¡ç‰¹èŒä¸šç”Ÿæ¶¯ç³»ç»Ÿ
â”‚   â”œâ”€â”€ photographer-system.md      # æ‘„å½±å¸ˆç”Ÿæ¶¯ç³»ç»Ÿ
â”‚   â”œâ”€â”€ random-model.md             # éšæœºæ¨¡ç‰¹ç”Ÿæˆè§„åˆ™
â”‚   â”œâ”€â”€ equipment-requirements.md   # å™¨æç³»ç»Ÿ
â”‚   â”œâ”€â”€ censorship-system.md        # å†…å®¹å®¡æŸ¥ç³»ç»Ÿ
â”‚   â””â”€â”€ writing-style.md            # åŒ—äº¬è¯é£æ ¼æŒ‡å—
â”‚
â”œâ”€â”€ ğŸ“‚ docs/                         # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ CONFIG_SYSTEM.md            # é…ç½®ç³»ç»Ÿè¯¦ç»†è¯´æ˜
â”‚   â”œâ”€â”€ CONFIG_QUICK_GUIDE.md       # é…ç½®å¿«é€Ÿå‚è€ƒ
â”‚   â”œâ”€â”€ game-value-system.md        # æ¸¸æˆå€¼ç³»ç»Ÿè®¾è®¡
â”‚   â””â”€â”€ relationship-system-draft.md # å…³ç³»ç³»ç»Ÿè‰ç¨¿
â”‚
â”œâ”€â”€ ğŸ“‚ modules/ (src/)               # æ„å»ºå·¥å…·æ¨¡å—
â”‚   â”œâ”€â”€ constants.js                # å¸¸é‡å®šä¹‰
â”‚   â”œâ”€â”€ data-loader.js              # æ•°æ®åŠ è½½å™¨
â”‚   â””â”€â”€ data-validator.js           # æ•°æ®éªŒè¯å™¨
â”‚
â”œâ”€â”€ build-config.js                 # é…ç½®æ„å»ºè„šæœ¬
â”œâ”€â”€ verify-config.js                # é…ç½®éªŒè¯è„šæœ¬
â”œâ”€â”€ analyze-tokens.js               # Token åˆ†æå·¥å…· â­ NEW
â”œâ”€â”€ build.js                        # ä»ªè¡¨æ¿æ„å»ºè„šæœ¬
â”œâ”€â”€ dev-server.js                   # å¼€å‘æœåŠ¡å™¨
â”œâ”€â”€ package.json                    # é¡¹ç›®ä¾èµ–é…ç½®
â””â”€â”€ README.md                       # æœ¬æ–‡ä»¶
```

## ğŸ® æ¸¸æˆæ ¸å¿ƒç³»ç»Ÿ

### 1. è§’è‰²è®¾å®šç³»ç»Ÿ

#### æ‘„å½±å¸ˆï¼ˆ{{user}}ï¼‰
- **è¡Œä¸šç­‰çº§** - ä¸“ä¸š â†’ èµ„æ·± â†’ åå®¶ï¼ˆ3 ä¸ªå±‚çº§ï¼‰
- **å •è½åº¦** - 0-100ï¼ˆé“å¾·åº•çº¿æŒ‡æ•°ï¼‰
- **èµ„é‡‘** - ç”¨äºå‡çº§å™¨æå’Œæ”¯ä»˜å¼€æ”¯
- **å™¨æç³»ç»Ÿ** - ç›¸æœºã€é•œå¤´ã€ç¯å…‰ç­‰ï¼ˆå½±å“æ‹æ‘„æ•ˆæœå’Œå¥½æ„Ÿåº¦ï¼‰

è¯¦è§ï¼š[worldbooks/photographer-system.md](./worldbooks/photographer-system.md)

#### æ¨¡ç‰¹
- **å±‚çº§** - æ–°æ‰‹ â†’ è¿›é˜¶ â†’ èµ„æ·±
- **å •è½åº¦** - 0-100ï¼ˆè¢«è¯±æƒ‘çš„ç¨‹åº¦ï¼‰
- **å¥½æ„Ÿåº¦** - -100 ~ 100ï¼ˆå¯¹æ‘„å½±å¸ˆçš„æ„Ÿæƒ…ï¼‰
- **æ€§çˆ±å­—æ®µ** - ä¹³æˆ¿ã€å°ç©´ã€è‚›é—¨æè¿°ï¼ˆä¸å •è½åº¦å’Œå¥½æ„Ÿåº¦è”åŠ¨ï¼‰

è¯¦è§ï¼š[worldbooks/model-system.md](./worldbooks/model-system.md)

### 2. å¥½æ„Ÿåº¦ç³»ç»Ÿ

| èŒƒå›´ | çŠ¶æ€ | è¡¨ç° |
|------|------|------|
| -100 ~ -1 | åŒæ¶ | æ‹’ç»åˆä½œã€å¯èƒ½ä¸¾æŠ¥ |
| 0 | ä¸­ç«‹ | å†·æ·¡å•†ä¸š |
| 1 ~ 50 | åˆæ­¥å¥½æ„Ÿ | ä¿¡ä»»å¢åŠ ã€é…åˆæå‡ |
| 51 ~ 80 | æ·±çˆ± | ä¸»åŠ¨ç¤ºå¥½ã€å¯èƒ½çŒ®èº« |
| 81 ~ 100 | æç«¯ä¾èµ– | å®Œå…¨ä¿¡ä»»ã€ä¸ºä»–åšä»»ä½•äº‹ |

è¯¦è§ï¼š[worldbooks/favor-system.md](./worldbooks/favor-system.md)

### 3. éšæœºæ¨¡ç‰¹ç”Ÿæˆ

ç³»ç»Ÿä¼šæ ¹æ®ç©å®¶çš„è¡Œä¸ºè‡ªåŠ¨ç”Ÿæˆå…·æœ‰ç‹¬ç«‹äººæ ¼çš„éšæœºæ¨¡ç‰¹ï¼š
- è‡ªåŠ¨åˆ¤æ–­ï¼šæ ¹æ®æ‘„å½±å¸ˆç­‰çº§ã€æŠ¥é…¬ã€è£…å¤‡å†³å®šåˆä½œæ„å‘
- ç‹¬ç«‹æ‹’ç»ï¼šå®åŠ›ä¸åŒ¹é…æ—¶ä¼šå§”å©‰æˆ–ç›´æ¥æ‹’ç»
- æˆé•¿å˜åŒ–ï¼šå¥½æ„Ÿåº¦å‡æ¸©æ—¶åŸæœ¬æ‹’ç»å¯èƒ½å˜æˆ"ä¸ºä½ ç ´ä¾‹"

è¯¦è§ï¼š[worldbooks/random-model.md](./worldbooks/random-model.md)

### 4. åŒ—äº¬è¯é£æ ¼ç³»ç»Ÿ

ç¡®ä¿æ‰€æœ‰ NPC å°è¯ç¬¦åˆåŒ—äº¬æœ¬åœ°ç‰¹è‰²ï¼š
- å„¿åŒ–éŸ³ï¼šè‡ªç„¶èå…¥ï¼ˆä¸è¿‡åº¦ï¼‰
- è„è¯åˆ†çº§ï¼šä¸å •è½åº¦ç›¸å…³ï¼ˆå •è½åº¦è¶Šé«˜è¶Šå¸¸ç”¨ï¼‰
- ç§°å‘¼å‡çº§ï¼šä»"æ‚¨"â†’"å“¥ä»¬å„¿"â†’"äº²çˆ±çš„"ï¼ˆå…³ç³»å‡æ¸©ï¼‰

è¯¦è§ï¼š[worldbooks/writing-style.md](./worldbooks/writing-style.md)

## âš™ï¸ é…ç½®ç³»ç»Ÿè¯´æ˜

### æ•°æ®æµ

```
status.yaml (Schema å®šä¹‰)          status.json (è¿è¡Œæ—¶è¦†ç›–å€¼)
        â†“                                    â†“
    é»˜è®¤å€¼                                æ–°å€¼
        â†“                                    â†“
        â””â”€â”€â”€â”€â”€â”€ build-config.js â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
            status-vars.debug.json (åˆå¹¶æ•°æ®)
                        â†“
              verify-config.js (éªŒè¯)
                        â†“
              SillyTavern è§’è‰²å¡åˆå§‹åŒ–
```

### æ·»åŠ æ–°å­—æ®µçš„æ­¥éª¤

1. **ç¼–è¾‘ `data/status.yaml`** å®šä¹‰æ–°å­—æ®µ

```yaml
æ–°äººç‰©:
  fields:
    æ–°å­—æ®µå:
      type: "string"  # æˆ– $range, $enum, $list ç­‰
      default: "é»˜è®¤å€¼"
      description: "å­—æ®µè¯´æ˜"
```

2. **è¿è¡Œæ„å»ºå‘½ä»¤**

```bash
pnpm config:build
```

3. **å¯é€‰ï¼šåœ¨ `data/status.json` ä¸­è‡ªå®šä¹‰å€¼**

4. **éªŒè¯**

```bash
pnpm config:verify
```

è¯¦è§ï¼š[docs/CONFIG_QUICK_GUIDE.md](./docs/CONFIG_QUICK_GUIDE.md)

## ğŸ“Š Token ç»Ÿè®¡

### å½“å‰ Worldbooks ç»Ÿè®¡ï¼ˆé¢„ä¼°ï¼‰

```
æ€»æ–‡ä»¶æ•°ï¼š       11 ä¸ª
æ€» Token æ•°ï¼š    ~20,151 tokens
å¹³å‡æ¯ä¸ªæ–‡ä»¶ï¼š   1,832 tokens
æœ€å¤§æ–‡ä»¶ï¼š       {{user}}.md (3,221 tokens)
æœ€å°æ–‡ä»¶ï¼š       photographer-system.md (1,034 tokens)
```

### æ’åå‰ 5 çš„æ–‡ä»¶

1. **{{user}}.md** - 3,221 tokensï¼ˆ16.0%ï¼‰- æ‘„å½±å¸ˆè®¾å®š
2. **status.md** - 2,712 tokensï¼ˆ13.5%ï¼‰- çŠ¶æ€ç³»ç»Ÿ
3. **writing-style.md** - 2,399 tokensï¼ˆ11.9%ï¼‰- åŒ—äº¬è¯é£æ ¼
4. **moral-system.md** - 2,160 tokensï¼ˆ10.7%ï¼‰- å •è½åº¦ç³»ç»Ÿ
5. **random-model.md** - 1,638 tokensï¼ˆ8.1%ï¼‰- éšæœºæ¨¡ç‰¹ç”Ÿæˆ

## ğŸ› ï¸ å¯ç”¨å‘½ä»¤

### é…ç½®ç›¸å…³

```bash
pnpm config:build       # æ„å»ºé…ç½®ï¼ˆåŒæ­¥ yaml åˆ° jsonï¼‰
pnpm config:verify      # éªŒè¯é…ç½®ä¸€è‡´æ€§
```

### Token åˆ†æ

```bash
pnpm analyze:tokens                # æ ‡å‡†ç»Ÿè®¡è¡¨
pnpm analyze:tokens:verbose        # è¯¦ç»†åˆ†æ
pnpm analyze:tokens:json           # JSON æ ¼å¼
node analyze-tokens.js --help      # æŸ¥çœ‹æ‰€æœ‰é€‰é¡¹
```

### å‰ç«¯ä»ªè¡¨æ¿

```bash
pnpm build              # æ„å»ºï¼ˆå¼€å‘ï¼‰
pnpm build:prod         # æ„å»ºï¼ˆç”Ÿäº§ï¼‰
pnpm build:prod:debug   # æ„å»ºï¼ˆç”Ÿäº§ï¼Œæ— å‹ç¼©ï¼‰
pnpm dev                # å¼€å‘æœåŠ¡å™¨ï¼ˆçƒ­é‡è½½ï¼‰
```

## ğŸ“– è¯¦ç»†æ–‡æ¡£

| æ–‡æ¡£ | è¯´æ˜ |
|------|------|
| [TOKEN_ANALYSIS.md](./TOKEN_ANALYSIS.md) | Token åˆ†æå·¥å…·çš„å®Œæ•´ä½¿ç”¨æŒ‡å— |
| [docs/CONFIG_SYSTEM.md](./docs/CONFIG_SYSTEM.md) | é…ç½®ç³»ç»Ÿçš„æ·±åº¦è®²è§£ |
| [docs/CONFIG_QUICK_GUIDE.md](./docs/CONFIG_QUICK_GUIDE.md) | é…ç½®å¿«é€Ÿå‚è€ƒå’Œæ•…éšœæ’é™¤ |
| [docs/game-value-system.md](./docs/game-value-system.md) | æ¸¸æˆå€¼ç³»ç»Ÿè®¾è®¡æ–‡æ¡£ |

## ğŸ¯ å¼€å‘å·¥ä½œæµ

### 1. æœ¬åœ°å¼€å‘

```bash
# å®‰è£…ä¾èµ–
pnpm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆçƒ­é‡è½½ï¼‰
pnpm dev

# åœ¨å¦ä¸€ä¸ªç»ˆç«¯éªŒè¯é…ç½®
pnpm config:verify
```

### 2. æ·»åŠ æ–°åŠŸèƒ½

```bash
# ä¿®æ”¹ worldbooks æˆ–é…ç½®æ–‡ä»¶

# éªŒè¯é…ç½®
pnpm config:build && pnpm config:verify

# æ£€æŸ¥ token å½±å“
pnpm analyze:tokens:verbose

# æäº¤æ›´æ”¹
git add .
git commit -m "æè¿°"
```

### 3. ç”Ÿäº§éƒ¨ç½²

```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm build:prod

# ç”Ÿæˆ token æŠ¥å‘Š
pnpm analyze:tokens:json > tokens_report.json

# æ¨é€åˆ°è¿œç¨‹
git push
```

## ğŸ“Š æœ€è¿‘æ›´æ–°

### v1.2.0 (2025-11-16)

âœ… **æ–°å¢åŠŸèƒ½**
- æ·»åŠ  Token åˆ†æå·¥å…· (`analyze-tokens.js`)
- æ”¯æŒå¤šç§è¾“å‡ºæ ¼å¼ï¼ˆè¡¨æ ¼/JSON/CSVï¼‰
- æ”¯æŒçµæ´»çš„æ’åºå’Œè¿‡æ»¤é€‰é¡¹

âœ… **æ–‡æ¡£æ”¹è¿›**
- å®Œæ•´çš„ TOKEN_ANALYSIS.md ä½¿ç”¨æŒ‡å—
- æ›´æ–°äº†é¡¹ç›® README
- ä¼˜åŒ–äº† random-model.md çš„æ–‡æ¡£ç»“æ„

âœ… **Bug ä¿®å¤**
- ä¿®å¤ status.yaml çš„ç¼©è¿›é”™è¯¯
- å®Œå–„äº† random-model.md çš„ç»†èŠ‚æè¿°

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“ æ³¨æ„äº‹é¡¹

- âš ï¸ ä¿®æ”¹ `status.yaml` åå¿…é¡»è¿è¡Œ `pnpm config:build`
- âš ï¸ ä¸è¦æ‰‹åŠ¨ç¼–è¾‘ `status-vars.debug.json`ï¼ˆä¼šè¢«è¦†ç›–ï¼‰
- âš ï¸ worldbooks æ–‡ä»¶åº”éµå¾ªåŒ—äº¬è¯é£æ ¼æŒ‡å—
- âœ… æ‰€æœ‰é‡å¤§æ›´æ”¹åº”æ£€æŸ¥ token å½±å“

## ğŸ“ è”ç³»æ–¹å¼

- é¡¹ç›®åœ°å€ï¼šhttps://github.com/sst/beijing-models
- æŠ¥å‘Šé—®é¢˜ï¼šGitHub Issues
- è®¨è®ºåŠŸèƒ½ï¼šGitHub Discussions

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ LICENSE æ–‡ä»¶

---

**æœ€åæ›´æ–°**ï¼š2025-11-16  
**å½“å‰åˆ†æ”¯**ï¼šsystems  
**æäº¤æ•°**ï¼š9 commits

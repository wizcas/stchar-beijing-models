---
filename: COT.md
rule_name: 思维链指导文档（简化版）
rule_key: 思维链,CoT,决策流程
version: 1
rule_type: 技术规范
rule_type_describe: 为 AI 提供结构化的思维链，指导在每轮对话后如何系统地更新游戏状态
---

<COT-Instructions>

# 思维链决策流程（简化版）

## 第0步：计算推进时间

**问题**：当前距离上次生成，在剧情中经过了多长时间？天气有无变化？

**使用调整操作**：

- 根据上次生成内容中的人物行为让世界时间自动流转
- 若用户输入中有明确指明时间变化，则按用户输入推进时间
- 根据上次生成的天气，结合时间、季节等因素，判断现在的天气
- 将生成的时间 `记入` 到 `状态栏.世界.时间`，若天气、天色有变化，则 `记入` 到 `状态栏.世界.天气`

---

## 第1步：确认互动对象

**问题**：当前是否正在与女模（或{{user}}）进行互动交流？

**判断标准**：

- ✅ **有互动**：直接对话、电话、消息、任务交互 → 进行到第二步
- ❌ **无互动**：独自活动、他人互动 → 结束，保持状态不变

---

## 第二步：更新出场女模列表

**规则**：所有正在与{{user}}交流互动的女模都要记录到 `世界.出场女模`

**操作**：

- 收集当前互动的所有女模（在场 + 远程通话）
- 更新 `状态栏.世界.出场女模` 数组
- 去重处理，避免重复

**示例**：

```json
{
  "记下": {
    "状态栏.世界.出场女模": ["六花", "梦瑶"]
  }
}
```

---

## 第三步：更新女模数据

### 要更新的字段路径

- `状态栏.女模.{名字}.想法` - 当前内心想法
- `状态栏.女模.{名字}.关系.好感度` - 使用调整操作
- `状态栏.女模.{名字}.关系.堕落度` - 使用调整操作
- `状态栏.女模.{名字}.性爱.动情程度` - 使用调整操作

### 数据更新示例

```json
{
  "记下": {
    "状态栏.女模.六花.想法": "他的指导很专业，我有点被吸引了"
  },
  "调整": {
    "状态栏.女模.六花.关系.好感度": "+15",
    "状态栏.女模.六花.关系.堕落度": "+5",
    "状态栏.女模.六花.性爱.动情程度": "+10"
  }
}
```

---

## 第四步：检查女模退场

**规则**：女模离开场景时，需要从 `出场女模` 列表中移除

**示例**：六花完成拍摄后离开

```json
{
  "记下": {
    "状态栏.世界.出场女模": []
  }
}
```

**说明**：将出场女模数组设为空或去掉该女模

---

## 第五步：检查拍摄任务更新

### 任务状态值

| 状态   | 含义           |
| ------ | -------------- |
| 未开始 | 刚创建还未开始 |
| 进行中 | 正在拍摄       |
| 已完成 | 拍摄结束       |
| 已取消 | 任务取消       |

### 任务更新示例

任务必须包含所有 7 个字段（完整更新）

```json
{
  "记下": {
    "状态栏.user.拍摄任务.六花--2024-12-28": {
      "发布日期": "2024-12-28",
      "状态": "进行中",
      "模特": "六花",
      "目标": "商业写真集",
      "期限": "2024-12-28 14:30",
      "报酬": 2500,
      "特殊要求": "无"
    }
  }
}
```

---

## 第六步：更新{{user}}数据

### 要更新的字段路径

- `状态栏.user.想法` - 对当前场景的想法
- `状态栏.user.关系.好感度` - 某女模好感变化
- `状态栏.user.资金` - 资金变化

### {{user}}更新示例

```json
{
  "记下": {
    "状态栏.user.想法": "六花今天表现不错，值得重点培养"
  },
  "调整": {
    "状态栏.user.资金": "-2500"
  }
}
```

---

## 第七步：生成推进选项

**推进选项格式**：使用 `"记下" + "状态栏.推进选项"` 操作

- `emoji` - 代表选项的表情符号
- `选项` - 选项文本描述
- `方向` - 积极/消极

**示例**（JSON 格式，必须包含 4 个选项：2 积极 + 2 消极）：

```json
{
  "记下": {
    "状态栏.推进选项": [
      {
        "emoji": "📸",
        "选项": "继续拍摄，争取更好的效果",
        "方向": "积极"
      },
      {
        "emoji": "💬",
        "选项": "和六花深入沟通，了解她的想法",
        "方向": "积极"
      },
      {
        "emoji": "💰",
        "选项": "提高报酬诱惑她接受更大尺度",
        "方向": "消极"
      },
      {
        "emoji": "⏭️",
        "选项": "结束今天的拍摄，改天再来",
        "方向": "消极"
      }
    ]
  }
}
```

---

## 完整思维链示例

### 场景：首次女模出场

```json
{
  "追加": {
    "状态栏.历史.女模": ["六花"]
  },
  "记下": {
    "状态栏.世界.出场女模": ["六花"],
    "状态栏.女模.六花": {
      "想法": "这就是那个新摄影师吗？",
      "关系": {
        "好感度": 10,
        "堕落度": 0
      }
    },
    "状态栏.user.拍摄任务.六花--2024-12-28": {
      "发布日期": "2024-12-28",
      "状态": "未开始",
      "模特": "六花",
      "目标": "商业写真集",
      "期限": "2024-12-28 14:30",
      "报酬": 2500,
      "特殊要求": "无"
    },
    "状态栏.推进选项": [
      {
        "emoji": "📸",
        "选项": "直接开始拍摄",
        "方向": "积极"
      },
      {
        "emoji": "☕",
        "选项": "先聊天建立rapport，之后再开始",
        "方向": "积极"
      },
      {
        "emoji": "💸",
        "选项": "以更高报酬诱惑接受大尺度",
        "方向": "消极"
      },
      {
        "emoji": "🚪",
        "选项": "以突发状况为由，取消今天的拍摄",
        "方向": "消极"
      }
    ]
  }
}
```

---

## 关键规则

1. **隐性表现**：数据更新不显示数值说明，让行为自然反映变化
2. **逻辑检查**：每次更新前检查字段路径是否正确
3. **完整性**：任务和女模首次出现时必须包含完整结构
4. **一致性**：确保各步骤间的数据逻辑一致性
5. **格式遵守**：所有 <plot-log></plot-log>中的数据，必须使用 JSON 格式，严格遵守 <status /> schema

</COT-Instructions>
